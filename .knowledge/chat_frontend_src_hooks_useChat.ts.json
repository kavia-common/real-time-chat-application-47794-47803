{"is_source_file": true, "format": "TypeScript", "description": "A React hook implementation (`useChat`) managing WebSocket connections for a real-time chat application, including message handling, connection status, and mock fallback logic.", "external_files": ["@/lib/env", "@/lib/types", "@/lib/utils"], "external_methods": ["loadMessages", "persistMessages", "uid"], "published": ["useChat"], "classes": [], "methods": [{"name": "function safeParse(input: any) { safeParse", "description": "A utility function to parse JSON input safely, returning the input itself if parsing fails.", "scope": "", "scopeKind": ""}, {"name": "export function useChat(username: string = \"You\") { useChat", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["useCallback", "useEffect", "useMemo", "useRef", "useState", "loadMessages", "persistMessages", "uid", "JSON.parse", "JSON.stringify"], "search-terms": ["useChat", "WebSocket connection hook", "message list management", "connection status", "mock fallback", "React hooks", "TypeScript chat hook"], "state": 2, "file_id": 15, "knowledge_revision": 33, "git_revision": "", "ctags": [{"_type": "tag", "name": "String", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const text = typeof data === \"string\" ? data : data?.text ?? String(evt.data);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "api", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const api = useMemo($/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "author", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const author = typeof data === \"string\" ? \"Remote\" : data?.author ?? \"Remote\";$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "cached", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^    const cached = loadMessages();$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const data = safeParse(evt.data);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const text = typeof data === \"string\" ? data : data?.text ?? String(evt.data);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "delay", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const delay = 800 + Math.round(Math.random() * 600);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "echo", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^            const next = [...prev, echo];$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "echo", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^          const echo: ChatMessage = {$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "messages", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const [messages, setMessages] = useState<ChatMessage[]>([]);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^          const next = [...prev, msg];$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const msg: ChatMessage = {$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "myMsg", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const next = [...prev, myMsg];$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "myMsg", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^      const myMsg: ChatMessage = {$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "next", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^            const next = [...prev, echo];$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "next", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^          const next = [...prev, msg];$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "next", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const next = [...prev, myMsg];$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "safeParse", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^function safeParse(input: any) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "sendMessage", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const sendMessage = useCallback($/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "setMessages", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const [messages, setMessages] = useState<ChatMessage[]>([]);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "setStatus", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const [status, setStatus] = useState<ConnectionStatus>(\"connecting\");$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "setUsingMock", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const [usingMock, setUsingMock] = useState<boolean>(false);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "socket", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^      const socket = new WebSocket(wsUrl);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const [status, setStatus] = useState<ConnectionStatus>(\"connecting\");$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "text", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const text = typeof data === \"string\" ? data : data?.text ?? String(evt.data);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "ts", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const ts =$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "useChat", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^export function useChat(username: string = \"You\") {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "usingMock", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const [usingMock, setUsingMock] = useState<boolean>(false);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "wsRef", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const wsRef = useRef<WebSocket | null>(null);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "wsUrl", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const wsUrl = env.NEXT_PUBLIC_WS_URL?.trim();$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}], "hash": "0d92464f4b5ee2d6aabf5ce76d81b399", "format-version": 4, "code-base-name": "chat_frontend", "filename": "chat_frontend/src/hooks/useChat.ts", "revision_history": [{"33": ""}]}