{"is_source_file": true, "format": "TypeScript", "description": "This is a React custom hook 'useChat' for managing a WebSocket connection and chat messages, including mock fallback behavior.", "external_files": ["@/lib/env", "@/lib/types", "@/lib/utils"], "external_methods": ["loadMessages", "persistMessages", "uid"], "published": ["useChat"], "classes": [], "methods": [{"name": "export function useChat(username: string = \"You\") { useChat", "description": "Custom React Hook that manages WebSocket connection, message state, and message sending logic.", "scope": "", "scopeKind": ""}, {"name": "function safeParse(input: unknown): unknown { safeParse", "description": "Utility function to parse JSON strings safely.", "scope": "", "scopeKind": ""}], "calls": ["loadMessages", "persistMessages", "uid", "useState", "useEffect", "useRef", "useCallback", "useMemo", "JSON.parse", "JSON.stringify"], "search-terms": ["useChat", "WebSocket connection", "message list", "connection status", "mock fallback", "useEffect cache load", "sendMessage function", "WebSocket event listeners"], "state": 2, "file_id": 15, "knowledge_revision": 47, "git_revision": "eae817265378664606aa5fa768ae8f66b2e4d2d6", "revision_history": [{"33": ""}, {"47": "eae817265378664606aa5fa768ae8f66b2e4d2d6"}], "ctags": [{"_type": "tag", "name": "api", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const api = useMemo($/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "cached", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^    const cached = loadMessages();$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const data = safeParse(evt.data);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "delay", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const delay = 800 + Math.round(Math.random() * 600);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "echo", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^            const next = [...prev, echo];$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "echo", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^          const echo: ChatMessage = {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "isStructured", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const isStructured = (v: unknown): v is { author?: string; text?: string; timestamp?: nu/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "messages", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const [messages, setMessages] = useState<ChatMessage[]>([]);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^          const next = [...prev, msg];$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const msg: ChatMessage = {$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "myMsg", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const next = [...prev, myMsg];$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "myMsg", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^      const myMsg: ChatMessage = {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "next", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^            const next = [...prev, echo];$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "next", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^          const next = [...prev, msg];$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "next", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^        const next = [...prev, myMsg];$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "safeParse", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^function safeParse(input: unknown): unknown {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "sendMessage", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const sendMessage = useCallback($/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "setMessages", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const [messages, setMessages] = useState<ChatMessage[]>([]);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "setStatus", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const [status, setStatus] = useState<ConnectionStatus>(\"connecting\");$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "setUsingMock", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const [usingMock, setUsingMock] = useState<boolean>(false);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "socket", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^      const socket = new WebSocket(wsUrl);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const [status, setStatus] = useState<ConnectionStatus>(\"connecting\");$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "useChat", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^export function useChat(username: string = \"You\") {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "usingMock", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const [usingMock, setUsingMock] = useState<boolean>(false);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "wsRef", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const wsRef = useRef<WebSocket | null>(null);$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}, {"_type": "tag", "name": "wsUrl", "path": "/home/kavia/workspace/code-generation/real-time-chat-application-47794-47803/chat_frontend/src/hooks/useChat.ts", "pattern": "/^  const wsUrl = env.NEXT_PUBLIC_WS_URL?.trim();$/", "language": "TypeScript", "kind": "constant", "scope": "useChat", "scopeKind": "function"}], "hash": "fa81a8b5ebcb5212ad063ef89d9366a7", "format-version": 4, "code-base-name": "chat_frontend", "filename": "chat_frontend/src/hooks/useChat.ts"}